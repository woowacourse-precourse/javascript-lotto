# 미션 - 로또

## 🚀 구현할 기능 목록

- [x] 로또를 발행 한다.
  - [x] 1~45에 해당하는 숫자를 뽑는다. 
  - [x] 숫자 6개가 중복되지 않는다.
  - [x] 숫자 6개는 정렬이 되어 있다.
- [x] 로또를 구입한다.
  - [x] 로또 구입 금액을 입력 받으면 얼마큼 로또를 살 수 있는지 계산한다.
    - [x] 금액을 잘못 입력하면 throw로 예외를 발생시킨다.
      - [x] 입력한 금액이 숫자가 아닌 경우.
      - [x] 입력한 금액이 1000원 단위로 나누어 떨어지지 않는 경우.
  - [x] 해당 개수 만큼 로또를 발행한다.
- [ ] 로또가 당첨 되었는지 확인한다.
  - [ ] 당첨 번호가 구매한 로또 번호에 있는지 확인한다.
  - [ ] 일치하는 번호의 수를 헤아린다.
  - [ ] 헤아린 수에 따라 당첨 등수를 정한다.
    - [ ] 5개일 때만 추가로 보너스 번호가 있는지 확인한다.
- [ ] 수익률을 계산한다. (소수점 둘째 자리에서 반올림)
- [ ] 예외 상황에서는 throw로 예외를 발생시키며 `[ERROR]` 로 시작하는 문구를 출력한다.
  - [ ] ~~금액~~
    - [ ] ~~입력한 금액이 숫자가 아닌 경우.~~
    - [ ] ~~입력한 금액이 1000원 단위로 나누어 떨어지지 않는 경우.~~
  - [ ] 당첨 번호
    - [ ] 입력한 당첨 번호에 `,` 과 숫자 이외의 문자가 있는 경우.
    - [ ] 입력한 당첨 번호가 6개의 숫자가 아닌 경우.
    - [ ] 입력한 당첨 번호가 1~45 사이의 숫자가 아닌 경우.
  - [ ] 보너스 번호
    - [ ] 입력한 보너스 번호가 숫자가 아닌 경우
    - [ ] 입력한 보너스 번호가 1~45 사이의 숫자가 아닌 경우.



### 구현 방향

* 우선 Lotto 클래스를 살펴보면 numbers가 private 필드로 선언되어 있고 생성자에서는 numbers를 받아서 저장하게 되어 있음.
  * 따라서 numbers를 외부에서 확인 할 수 없으니 당첨 번호 확인은 Lotto 클래스에서 진행하고.
  * Lotto인스턴스를 만드는 부분은 LottoMachine 클래스를 만들어서 자동으로 번호를 뽑는 기계처럼 구현할 예정.
  * 그러므로 컴퓨터에서 랜덤으로 뽑아내는 번호를 validate 하는 부분은 LottoMachine에서 진행하도록 구현할 예정.



## 💡 알게된 내용

### 아뿔싸

지난주 과제 제출을 마치고 프로그래밍 요구 사항의 `Node.js 14 버전에서 실행 가능해야 한다.`라는 문구의 의미를 깨닫게 되었다. 

```javascript
const app = new App();
app.play();
```

위의 코드를 가진 js 파일을 `node <파일명>.js`로 실행하면 정상 작동 하는지를 물어보는 것이었다.

이 사실을 모르고 구현만 해서 낸 나는 방금 node 명령어로 확인해본 결과 계속해서 입력을 받아들여 `낫싱`만 출력하는 상황인 것을 알게 되었다. 이또한 배움이리라 생각한다. 빵점이긴 한데, 점차 발전하는 모습을 보이면 되지 않을까...? 희망을 놓지는 말아 본다.

그럼 이번에는 Console.close()를 더 일찍 호출하여 중단하여야 하는데 언제 호출하여 중단하는지 그것을 확인알아야겠다.

이제서야 다들 promise를 사용해야 된다 그랬던 것이구나를 또 깨닫는다. 다른 사람들의 회고를 찾아봐야겠다.

근데 여기서 궁금증이 생기는데, js로 코드를 하는데 왜 굳이 node가 필요한 거지? node의 역할은 무엇일까 라는 생각도 든다.

### 도메인이란

실제 다루고자 하는 서비스의 비즈니스 로직이 들어있는 영역 계산을 한다거나 행위를 하는 것이 들어있는 부분이다.

즉, `도메인 로직에 단위 테스트를 구현해야 한다.`라는 말은 구현한 메서드 로직 별로 단위 테스트를 구현해야 한다는 말이라고 이해할 수 있겠다.

### 테스트를 한 파일씩 진행하기

지난 과제에서 테스트 코드를 돌릴 때 모든 파일이 한 번에 테스트가 진행되어 불편함이 있었다. 이번에는 테스트 코드의 시작점을 찾아 원하는 파일만 테스트가 진행되도록 하고 싶었다.

해당 방법을 찾지 못해서 우회하는 방법인

```bash
$ npm test -- <파일명>
```

명령어를 사용하기로 했다.

### 숫자 정렬하기

지난 과제에서는 숫자를 원소로 가진 배열을 정렬할 때 문제가 없었지만 이번주에는 문제가 생겼다. 바로 1자리를 초과하는 수는 첫 번째 숫자를 기준으로 정렬(문자열 정렬과 같이)이 된다는 사실이다. 지난주 과제는 1자리 숫자로만 이루어져 있기 때문에 정렬을 해도 문제가 없었던 것이다.

그래서 MDN 문서를 찾아본 결과 비교 함수(`compareFunction`)이 있어야 한다고 한다. 다음은 compareFunction의 설명이다.

* `compareFunction(a, b)`이 0보다 작은 경우 a를 b보다 낮은 색인으로 정렬합니다. 즉, a가 먼저옵니다.
* `compareFunction(a, b)`이 0을 반환하면 a와 b를 서로에 대해 변경하지 않고 모든 다른 요소에 대해 정렬합니다. 참고 : ECMAscript 표준은 이러한 동작을 보장하지 않으므로 모든 브라우저(예 : Mozilla 버전은 적어도 2003 년 이후 버전 임)가 이를 존중하지는 않습니다.
* `compareFunction(a, b)`이 0보다 큰 경우, b를 a보다 낮은 인덱스로 소트합니다.
* `compareFunction(a, b)`은 요소 a와 b의 특정 쌍이 두 개의 인수로 주어질 때 항상 동일한 값을 반환해야합니다. 일치하지 않는 결과가 반환되면 정렬 순서는 정의되지 않습니다.

따라서 오름차순으로 정렬하고 싶으면 비교 함수를 다음과 같이 정의하고 사용하면 된다.

```js
const numbers = [4, 2, 5, 1, 3];
function compareFunction(a, b) {
    return a - b;
}
numbers.sort(compareFunction); // [1, 2, 3, 4, 5]
```







> ## 🚀 기능 요구 사항
>
> 로또 게임 기능을 구현해야 한다. 로또 게임은 아래와 같은 규칙으로 진행된다.
>
> ```
> - 로또 번호의 숫자 범위는 1~45까지이다.
> - 1개의 로또를 발행할 때 중복되지 않는 6개의 숫자를 뽑는다.
> - 당첨 번호 추첨 시 중복되지 않는 숫자 6개와 보너스 번호 1개를 뽑는다.
> - 당첨은 1등부터 5등까지 있다. 당첨 기준과 금액은 아래와 같다.
>     - 1등: 6개 번호 일치 / 2,000,000,000원
>     - 2등: 5개 번호 + 보너스 번호 일치 / 30,000,000원
>     - 3등: 5개 번호 일치 / 1,500,000원
>     - 4등: 4개 번호 일치 / 50,000원
>     - 5등: 3개 번호 일치 / 5,000원
> ```
>
> - 로또 구입 금액을 입력하면 구입 금액에 해당하는 만큼 로또를 발행해야 한다.
> - 로또 1장의 가격은 1,000원이다.
> - 당첨 번호와 보너스 번호를 입력받는다.
> - 사용자가 구매한 로또 번호와 당첨 번호를 비교하여 당첨 내역 및 수익률을 출력하고 로또 게임을 종료한다.
> - 사용자가 잘못된 값을 입력할 경우 `throw`문을 사용해 예외를 발생시키고, "[ERROR]"로 시작하는 에러 메시지를 출력 후 종료한다.
>
> ### 입출력 요구 사항
>
> #### 입력
>
> - 로또 구입 금액을 입력 받는다. 구입 금액은 1,000원 단위로 입력 받으며 1,000원으로 나누어 떨어지지 않는 경우 예외 처리한다.
>
> ```
> 14000
> ```
>
> - 당첨 번호를 입력 받는다. 번호는 쉼표(,)를 기준으로 구분한다.
>
> ```
> 1,2,3,4,5,6
> ```
>
> - 보너스 번호를 입력 받는다.
>
> ```
> 7
> ```
>
> #### 출력
>
> - 발행한 로또 수량 및 번호를 출력한다. 로또 번호는 오름차순으로 정렬하여 보여준다.
>
> ```
> 8개를 구매했습니다.
> [8, 21, 23, 41, 42, 43]
> [3, 5, 11, 16, 32, 38]
> [7, 11, 16, 35, 36, 44]
> [1, 8, 11, 31, 41, 42]
> [13, 14, 16, 38, 42, 45]
> [7, 11, 30, 40, 42, 43]
> [2, 13, 22, 32, 38, 45]
> [1, 3, 5, 14, 22, 45]
> ```
>
> - 당첨 내역을 출력한다.
>
> ```
> 3개 일치 (5,000원) - 1개
> 4개 일치 (50,000원) - 0개
> 5개 일치 (1,500,000원) - 0개
> 5개 일치, 보너스 볼 일치 (30,000,000원) - 0개
> 6개 일치 (2,000,000,000원) - 0개
> ```
>
> - 수익률은 소수점 둘째 자리에서 반올림한다. (ex. 100.0%, 51.5%, 1,000,000.0%)
>
> ```
> 총 수익률은 62.5%입니다.
> ```
>
> - 예외 상황 시 에러 문구를 출력해야 한다. 단, 에러 문구는 "[ERROR]"로 시작해야 한다.
>
> ```
> [ERROR] 로또 번호는 1부터 45 사이의 숫자여야 합니다.
> ```
>
> #### 실행 결과 예시
>
> ```
> 구입금액을 입력해 주세요.
> 8000
> 
> 8개를 구매했습니다.
> [8, 21, 23, 41, 42, 43]
> [3, 5, 11, 16, 32, 38]
> [7, 11, 16, 35, 36, 44]
> [1, 8, 11, 31, 41, 42]
> [13, 14, 16, 38, 42, 45]
> [7, 11, 30, 40, 42, 43]
> [2, 13, 22, 32, 38, 45]
> [1, 3, 5, 14, 22, 45]
> 
> 당첨 번호를 입력해 주세요.
> 1,2,3,4,5,6
> 
> 보너스 번호를 입력해 주세요.
> 7
> 
> 당첨 통계
> ---
> 3개 일치 (5,000원) - 1개
> 4개 일치 (50,000원) - 0개
> 5개 일치 (1,500,000원) - 0개
> 5개 일치, 보너스 볼 일치 (30,000,000원) - 0개
> 6개 일치 (2,000,000,000원) - 0개
> 총 수익률은 62.5%입니다.
> ```
>
> ---
>
> ## 🎯 프로그래밍 요구 사항
>
> - Node.js 14 버전에서 실행 가능해야 한다. **Node.js 14에서 정상적으로 동작하지 않을 경우 0점 처리한다.**
> - 프로그램 실행의 시작점은 `App.js`의 `play` 메서드이다. 아래와 같이 프로그램을 실행시킬 수 있어야 한다.
>
> **예시**
>
> ```javascript
> const app = new App();
> app.play();
> ```
>
> - `package.json`을 변경할 수 없고 외부 라이브러리(jQuery, Lodash 등)를 사용하지 않는다. 순수 Vanilla JS로만 구현한다.
> - [JavaScript 코드 컨벤션](https://github.com/woowacourse/woowacourse-docs/tree/main/styleguide/javascript)을 지키면서 프로그래밍 한다
> - 프로그램 종료 시 `process.exit()`를 호출하지 않는다.
> - 프로그램 구현이 완료되면 `ApplicationTest`의 모든 테스트가 성공해야 한다. **테스트가 실패할 경우 0점 처리한다.**
> - 프로그래밍 요구 사항에서 달리 명시하지 않는 한 파일, 패키지 이름을 수정하거나 이동하지 않는다.
> - indent(인덴트, 들여쓰기) depth를 3이 넘지 않도록 구현한다. 2까지만 허용한다.
>   - 예를 들어 while문 안에 if문이 있으면 들여쓰기는 2이다.
>   - 힌트: indent(인덴트, 들여쓰기) depth를 줄이는 좋은 방법은 함수(또는 메서드)를 분리하면 된다.
> - 함수(또는 메서드)가 한 가지 일만 하도록 최대한 작게 만들어라.
> - Jest를 이용하여 본인이 정리한 기능 목록이 정상 동작함을 테스트 코드로 확인한다.
>
> ### 추가된 요구 사항
>
> - 함수(또는 메서드)의 길이가 15라인을 넘어가지 않도록 구현한다.
>   - 함수(또는 메서드)가 한 가지 일만 잘 하도록 구현한다.
> - else를 지양한다.
>   - 힌트: if 조건절에서 값을 return하는 방식으로 구현하면 else를 사용하지 않아도 된다.
>   - 때로는 if/else, switch문을 사용하는 것이 더 깔끔해 보일 수 있다. 어느 경우에 쓰는 것이 적절할지 스스로 고민해 본다.
> - 도메인 로직에 단위 테스트를 구현해야 한다. 단, UI(Console.readLine, Console.print) 로직에 대한 단위 테스트는 제외한다.
>   - 핵심 로직을 구현하는 코드와 UI를 담당하는 로직을 구분한다.
>   - 단위 테스트 작성이 익숙하지 않다면 `__tests__/LottoTest.js`를 참고하여 학습한 후 테스트를 구현한다.
>
> ### 라이브러리
>
> - [MissionUtils 라이브러리](https://github.com/woowacourse-projects/javascript-mission-utils#mission-utils)에서 제공하는 `Random` 및 `Console` API를 사용하여 구현해야 한다.
>   - Random 값 추출은 [MissionUtils 라이브러리](https://github.com/woowacourse-projects/javascript-mission-utils#mission-utils)의 `Random.pickUniqueNumbersInRange()`를 활용한다.
>   - 사용자의 값을 입력 받고 출력하기 위해서는 [MissionUtils 라이브러리](https://github.com/woowacourse-projects/javascript-mission-utils#mission-utils)에서 제공하는 `Console.readLine`, `Console.print`를 활용한다.
>
> #### 사용 예시
>
> ```javascript
> const numbers = MissionUtils.Random.pickUniqueNumbersInRange(1, 45, 6);
> ```
>
> ### Lotto 클래스
>
> - 제공된 `Lotto` 클래스를 활용해 구현해야 한다.
> - `numbers`의 `#` prefix를 변경할 수 없다.
> - `Lotto`에 필드를 추가할 수 없다.
>
> ```javascript
> class Lotto {
>   #numbers;
> 
>   constructor(numbers) {
>     this.validate(numbers);
>     this.#numbers = numbers;
>   }
> 
>   validate(numbers) {
>     if (numbers.length !== 6) {
>       throw new Error();
>     }
>   }
> 
>   // TODO: 추가 기능 구현
> }
> ```
>
> ---

